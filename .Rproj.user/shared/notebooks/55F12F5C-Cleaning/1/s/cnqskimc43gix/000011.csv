"0","# Load necessary libraries"
"0","library(dplyr)"
"0","library(ggplot2)"
"0",""
"0","# Calculate the total crimes to use for normalization if needed"
"0","total_crimes <- sum(crime$Vict.Sex %in% c(""M"", ""F""))"
"0",""
"0","# Aggregate crime data by victim's sex and normalize by the total crimes"
"0","crime_data_by_sex <- crime %>%"
"0","  filter(Vict.Sex %in% c(""M"", ""F"")) %>%"
"0","  group_by(Vict.Sex) %>%"
"0","  summarise(Total_Crimes = n(), .groups = 'drop') %>%"
"0","  mutate(Percentage = Total_Crimes / total_crimes * 100)  # Calculate percentage of total crimes"
"0",""
"0","# Plotting the data with scaled y-axis and adding percentage labels"
"0","ggplot(crime_data_by_sex, aes(x = Vict.Sex, y = Percentage, fill = Vict.Sex)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  geom_text(aes(label = sprintf(""%.2f%%"", Percentage)),  # Format labels to show as percentages"
"0","            vjust = -0.5,  # Adjust vertical position to be above the bar"
"0","            color = ""black"", size = 3.5) +"
"0","  labs(title = ""Total Crime Counts by Victim Sex (Scaled as % of Total)"","
"0","       x = ""Victim Sex"","
"0","       y = ""Percentage of Total Crimes (%)"") +"
"0","  scale_fill_manual(values = c(""M"" = ""blue"", ""F"" = ""pink"")) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 0),"
"0","        legend.title = element_blank())"
